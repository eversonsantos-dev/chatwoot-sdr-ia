<%# Ações rápidas para licenças SDR IA %>
<div class="sdr-ia-actions mt-6 p-4 bg-gray-50 rounded-lg">
  <h3 class="text-lg font-semibold mb-4">Ações Rápidas</h3>

  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <% if page.resource.trial? %>
      <!-- Estender Trial -->
      <%= form_with url: extend_trial_super_admin_sdr_ia_license_path(page.resource), method: :post, local: true, class: "inline" do |f| %>
        <div class="flex items-center gap-2">
          <%= f.number_field :days, value: 14, min: 1, max: 90, class: "w-16 px-2 py-1 border rounded" %>
          <%= f.submit "Estender Trial", class: "button button--primary text-sm" %>
        </div>
      <% end %>
    <% end %>

    <% if page.resource.active? %>
      <!-- Suspender -->
      <%= form_with url: suspend_super_admin_sdr_ia_license_path(page.resource), method: :post, local: true, class: "inline" do |f| %>
        <%= f.text_field :reason, placeholder: "Motivo (opcional)", class: "w-40 px-2 py-1 border rounded" %>
        <%= f.submit "Suspender", class: "button button--warning text-sm",
            data: { confirm: "Tem certeza que deseja suspender esta licença?" } %>
      <% end %>
    <% elsif page.resource.suspended? %>
      <!-- Reativar -->
      <%= button_to "Reativar", reactivate_super_admin_sdr_ia_license_path(page.resource),
          method: :post, class: "button button--success text-sm" %>
    <% end %>

    <!-- Resetar Uso -->
    <%= button_to "Resetar Uso", reset_usage_super_admin_sdr_ia_license_path(page.resource),
        method: :post, class: "button button--secondary text-sm",
        data: { confirm: "Isso irá zerar o contador de uso mensal. Continuar?" } %>

    <!-- Upgrade -->
    <% unless page.resource.license_type == 'enterprise' %>
      <%= form_with url: upgrade_super_admin_sdr_ia_license_path(page.resource), method: :post, local: true, class: "inline" do |f| %>
        <%= f.select :license_type,
            SdrIaLicense::LICENSE_TYPES.reject { |t| t == page.resource.license_type }.map { |t| [t.titleize, t] },
            {}, class: "px-2 py-1 border rounded" %>
        <%= f.submit "Upgrade", class: "button button--primary text-sm" %>
      <% end %>
    <% end %>
  </div>
</div>

<!-- Informações de Uso -->
<div class="usage-info mt-6 p-4 bg-white border rounded-lg">
  <h3 class="text-lg font-semibold mb-4">Uso Atual</h3>

  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <div class="stat-box p-3 bg-blue-50 rounded">
      <div class="text-2xl font-bold text-blue-600">
        <%= page.resource.monthly_lead_usage %> / <%= page.resource.monthly_lead_limit %>
      </div>
      <div class="text-sm text-gray-600">Leads este mês</div>
      <div class="mt-2 bg-gray-200 rounded-full h-2">
        <div class="bg-blue-600 h-2 rounded-full" style="width: <%= page.resource.usage_percentage %>%"></div>
      </div>
    </div>

    <div class="stat-box p-3 bg-green-50 rounded">
      <div class="text-2xl font-bold text-green-600">
        <%= page.resource.remaining_leads %>
      </div>
      <div class="text-sm text-gray-600">Leads restantes</div>
    </div>

    <% if page.resource.trial? && page.resource.trial_days_remaining %>
      <div class="stat-box p-3 bg-yellow-50 rounded">
        <div class="text-2xl font-bold text-yellow-600">
          <%= page.resource.trial_days_remaining %>
        </div>
        <div class="text-sm text-gray-600">Dias restantes no trial</div>
      </div>
    <% end %>

    <div class="stat-box p-3 bg-purple-50 rounded">
      <div class="text-lg font-bold text-purple-600">
        <%= page.resource.allowed_models.join(', ') %>
      </div>
      <div class="text-sm text-gray-600">Modelos permitidos</div>
    </div>
  </div>
</div>

<!-- Features Habilitadas -->
<div class="features-info mt-6 p-4 bg-white border rounded-lg">
  <h3 class="text-lg font-semibold mb-4">Features do Plano</h3>

  <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
    <div class="feature-badge flex items-center gap-2">
      <% if page.resource.custom_prompts_enabled? %>
        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
      <% else %>
        <span class="w-3 h-3 bg-red-500 rounded-full"></span>
      <% end %>
      <span>Prompts Customizados</span>
    </div>

    <div class="feature-badge flex items-center gap-2">
      <% if page.resource.api_access_enabled? %>
        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
      <% else %>
        <span class="w-3 h-3 bg-red-500 rounded-full"></span>
      <% end %>
      <span>Acesso API</span>
    </div>

    <div class="feature-badge flex items-center gap-2">
      <% if page.resource.knowledge_base_enabled? %>
        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
      <% else %>
        <span class="w-3 h-3 bg-red-500 rounded-full"></span>
      <% end %>
      <span>Base de Conhecimento</span>
    </div>

    <div class="feature-badge flex items-center gap-2">
      <% if page.resource.round_robin_enabled? %>
        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
      <% else %>
        <span class="w-3 h-3 bg-red-500 rounded-full"></span>
      <% end %>
      <span>Round Robin</span>
    </div>

    <div class="feature-badge flex items-center gap-2">
      <% if page.resource.audio_transcription_enabled? %>
        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
      <% else %>
        <span class="w-3 h-3 bg-red-500 rounded-full"></span>
      <% end %>
      <span>Transcrição de Áudio</span>
    </div>
  </div>
</div>
